# Reproducible Research: Peer Assessment 1

## Echo Global option TRUE
```{r setoptions, echo=TRUE}
library("knitr")
opts_chunk$set(echo = TRUE)
```

## Loading and preprocessing the data

```{r loadata}
unzip(zipfile="activity.zip")
data_raw <- read.csv("activity.csv", header = TRUE, sep = ",", 
                 colClasses = c("numeric", "character","integer"),
                 na.strings = "NA")
## Removing Na
data <- na.omit(data_raw)
```

## What is mean total number of steps taken per day?
###1.Calculate the total number of steps per day 
```{r sumsteps}
sumsteps <- aggregate(list(steps=data$steps), by=list(date=data$date),
                      FUN="sum")
```

###2.Histogram of the total number of steps taken each day

```{r qplot histo}
library(ggplot2)
qplot(sumsteps$steps, geom="histogram", 
      binwidth = (max(sumsteps$steps) - min(sumsteps$steps))/30,
      xlab = "Number of Steps",
      ylab = "Frequency") 
```

###3.Mean and median of the total number of steps taken per day

```{r mean and median}
mean(sumsteps$steps)
median(sumsteps$steps)
```

##What is the average daily activity pattern?

###1.Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
```{r time plot}
data.inter <- aggregate(list(steps=data$steps), by=list(interval=data$interval),
                      FUN="mean")
plot(data.inter$interval,data.inter$steps, type = "l",
     xlab="interval", ylab="step")
```

###2.Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r max}
data.inter[which.max(data.inter$steps),]
```